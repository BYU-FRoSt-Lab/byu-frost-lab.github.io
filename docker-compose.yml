services:
  astrowind:
    build:
      context: .
      target: dev
    container_name: astrowind
    environment:
      - NODE_ENV=development
    ports:
      - "8080:8080"
    # Mount project for live reload; keep node_modules in container to avoid host/guest conflicts
    volumes:
      - ./:/app:cached
      - /app/node_modules
    # Ensure the dev server binds to 0.0.0.0 so it's reachable from the host
    command: ["npx", "astro", "dev", "--port", "8080", "--host", "0.0.0.0"]
    
    

# Optional: define a named volume for node_modules if you prefer
#volumes:
#  node_modules: {}

# For interactive development, you can also run the following command directly:
# docker compose run --rm astrowind
# npx astro dev --port 8080 --host 0.0.0.0
